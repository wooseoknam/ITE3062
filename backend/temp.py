import numpy as np
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt
y_coordinates = [  # 주어진 y 좌표들
    317.0146, 317.0045, 317.0051, 317.0052, 316.9993, 329.8765, 329.8143, 364.9561, 487.0755, 548.3477,
    548.283, 594.0085, 638.7629, 640.6223, 640.6095, 639.2912, 621.8, 597.8968, 597.8951, 560.5022,
    486.3416, 449.8452, 449.8413, 404.0378, 337.6161, 324.8104, 324.789, 321.3218, 321.3854, 321.3258,
    317.0367, 317.0511, 317.052, 317.0463, 317.0452, 329.7192, 419.1635, 419.1953, 487.1016, 548.387,
    622.4566, 622.455, 638.7983, 640.6043, 633.5926, 633.582, 622.0148, 597.8949, 532.7699, 532.7932,
    486.3144, 449.705, 362.1791, 362.15, 337.5713, 324.7448, 321.2772, 321.3073, 321.3214, 317.0492,
    317.0308, 317.0268, 317.0263, 329.7197, 419.1594, 419.1573, 487.0111, 548.2689, 622.4786, 622.4962,
    638.7876, 640.568, 633.6023, 633.627, 621.9077, 597.9148, 532.8307, 532.8207, 486.3218, 449.849,
    362.0951, 362.0902, 337.5255, 324.7506, 321.39, 321.3858, 321.3638, 317.0014, 317.0138, 317.0035,
    317.0136, 329.689, 419.242, 419.2324, 487.0876, 548.3412, 622.4967, 622.5088, 638.8568, 640.5288,
    633.5669, 633.5787, 621.9329, 601.7832, 532.8343, 532.8151, 486.2714, 449.8255, 362.168, 362.1802,
    337.6136, 324.7548, 321.345, 321.3448, 321.3366
]
import numpy as np
from scipy.optimize import fsolve

# x 좌표는 0부터 시작하는 정수로 만듦
x = np.arange(len(y_coordinates))

# 실제 데이터 점들을 선으로 이어서 표시
plt.plot(x, y_coordinates, marker='o', color='blue', label='실제 데이터')
plt.xlabel('x')
plt.ylabel('y')
plt.title('실제 데이터')

# 미분해서 0이 되는 지점 찾기
dy = np.gradient(y_coordinates)  # 미분 계산
zero_points = np.where(np.diff(np.sign(dy)))[0]  # 미분값이 0이 되는 지점 찾기

# 찾은 지점들을 빨간색으로 표시
plt.plot(zero_points, np.array(y_coordinates)[zero_points], 'ro', label='미분값이 0인 지점')

plt.legend()
plt.show()

filtered_points = [(x_val, y_coordinates[x_val]) for x_val in zero_points if y_coordinates[x_val] >= 600]

# 결과 출력
print(f'미분해서 0이 되고 y값이 600 이상인 지점들: {filtered_points}')